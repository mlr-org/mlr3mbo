<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This is a helper function that generates a default Surrogate based on properties of the
bbotk::OptimInstance.
For numeric-only (including integers) parameter spaces without any dependencies:
A Kriging model &amp;#8220;&quot;regr.km&quot;&amp;#8221; with kernel &amp;#8220;&quot;matern3_2&quot;&amp;#8221; is created.
If the objective function is deterministic we add a small nugget effect (10^-8*Var(y),
y is vector of observed outcomes in current design) to increase numerical stability to
hopefully prevent crashes of DiceKriging.
Whether the objective function is deterministic can be observed from the objective function's
properties.
If the objective function is noisy the nugget effect will be estimated with
nugget.estim = TRUE.
Also jitter is set to TRUE to circumvent a problem with DiceKriging
where already trained input values produce the exact trained output.
Whether the objective function is noisy can be observed from the objective functions
properties.
Instead of the default &quot;BFGS&quot; optimization method we use rgenoud (&quot;gen&quot;),
which is a hybrid algorithm, to combine global search based on genetic algorithms and local search
based on gradients.
This may improve the model fit and will less frequently produce a constant surrogate model.


For mixed numeric-categorical parameter spaces, or spaces with conditional parameters:
A ranger regression forest &amp;#8220;&quot;regr.ranger&quot;&amp;#8221; with 500 trees is created.
The standard error of a prediction (if required by the infill criterion) is estimated via jackknife.
This is the se.method = &quot;jack&quot; option of the &amp;#8220;&quot;regr.ranger&quot;&amp;#8221; learner (default).
In any case, learners are encapsulated using &amp;#8220;&quot;evaluate&quot;&amp;#8221;, and a fallback learner is set,
in cases where the surrogate learner errors. Currently, the following learner is used as a fallback:
lrn(&quot;regr.ranger&quot;, num.trees = 20L, keep.inbag = TRUE, se.method = &quot;jack&quot;).
If additionally dependencies are present in the parameter space, inactive conditional parameters
are represented by missing NA values in the training design data.
We simply handle those with an imputation method, added to the ranger random forest, more
concretely we use po(&quot;imputesample&quot;) (for logicals) and po(&quot;imputeoor&quot;) (for anything else) from
package mlr3pipelines.
Characters are always encoded as factors via po(&quot;colapply&quot;).
Out of range imputation makes sense for tree-based methods and is usually hard to beat, see Ding et al. (2010).
In the case of dependencies, the following learner is used as a fallback:
lrn(&quot;regr.featureless&quot;).
If the instance is of class bbotk::OptimInstanceSingleCrit the learner is wrapped as a
SurrogateLearner.
If the instance is of class bbotk::OptimInstanceMultiCrit deep clones of the learner are
wrapped as a SurrogateLearnerCollection."><title>Default Surrogate — default_surrogate • mlr3mbo</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.6/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.6/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.6/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Default Surrogate — default_surrogate"><meta property="og:description" content="This is a helper function that generates a default Surrogate based on properties of the
bbotk::OptimInstance.
For numeric-only (including integers) parameter spaces without any dependencies:
A Kriging model &amp;#8220;&quot;regr.km&quot;&amp;#8221; with kernel &amp;#8220;&quot;matern3_2&quot;&amp;#8221; is created.
If the objective function is deterministic we add a small nugget effect (10^-8*Var(y),
y is vector of observed outcomes in current design) to increase numerical stability to
hopefully prevent crashes of DiceKriging.
Whether the objective function is deterministic can be observed from the objective function's
properties.
If the objective function is noisy the nugget effect will be estimated with
nugget.estim = TRUE.
Also jitter is set to TRUE to circumvent a problem with DiceKriging
where already trained input values produce the exact trained output.
Whether the objective function is noisy can be observed from the objective functions
properties.
Instead of the default &quot;BFGS&quot; optimization method we use rgenoud (&quot;gen&quot;),
which is a hybrid algorithm, to combine global search based on genetic algorithms and local search
based on gradients.
This may improve the model fit and will less frequently produce a constant surrogate model.


For mixed numeric-categorical parameter spaces, or spaces with conditional parameters:
A ranger regression forest &amp;#8220;&quot;regr.ranger&quot;&amp;#8221; with 500 trees is created.
The standard error of a prediction (if required by the infill criterion) is estimated via jackknife.
This is the se.method = &quot;jack&quot; option of the &amp;#8220;&quot;regr.ranger&quot;&amp;#8221; learner (default).
In any case, learners are encapsulated using &amp;#8220;&quot;evaluate&quot;&amp;#8221;, and a fallback learner is set,
in cases where the surrogate learner errors. Currently, the following learner is used as a fallback:
lrn(&quot;regr.ranger&quot;, num.trees = 20L, keep.inbag = TRUE, se.method = &quot;jack&quot;).
If additionally dependencies are present in the parameter space, inactive conditional parameters
are represented by missing NA values in the training design data.
We simply handle those with an imputation method, added to the ranger random forest, more
concretely we use po(&quot;imputesample&quot;) (for logicals) and po(&quot;imputeoor&quot;) (for anything else) from
package mlr3pipelines.
Characters are always encoded as factors via po(&quot;colapply&quot;).
Out of range imputation makes sense for tree-based methods and is usually hard to beat, see Ding et al. (2010).
In the case of dependencies, the following learner is used as a fallback:
lrn(&quot;regr.featureless&quot;).
If the instance is of class bbotk::OptimInstanceSingleCrit the learner is wrapped as a
SurrogateLearner.
If the instance is of class bbotk::OptimInstanceMultiCrit deep clones of the learner are
wrapped as a SurrogateLearnerCollection."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mlr3mbo</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa fa fa-file-alt"></span>
     
    Reference
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/mlr3mbo.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://mlr3book.mlr-org.com">
    <span class="fa fa fa fa-link"></span>
     
    mlr3book
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlr-org/mlr3mbo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Default Surrogate</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3mbo/blob/HEAD/R/mbo_defaults.R" class="external-link"><code>R/mbo_defaults.R</code></a></small>
      <div class="d-none name"><code>default_surrogate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a helper function that generates a default <a href="Surrogate.html">Surrogate</a> based on properties of the
<a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">bbotk::OptimInstance</a>.</p>
<p>For numeric-only (including integers) parameter spaces without any dependencies:</p><ul><li><p>A Kriging model “"regr.km"” with kernel “"matern3_2"” is created.</p></li>
<li><p>If the objective function is deterministic we add a small nugget effect (10^-8*Var(y),
y is vector of observed outcomes in current design) to increase numerical stability to
hopefully prevent crashes of <a href="https://CRAN.R-project.org/package=DiceKriging" class="external-link"><span class="pkg">DiceKriging</span></a>.
Whether the objective function is deterministic can be observed from the objective function's
properties.</p></li>
<li><p>If the objective function is noisy the nugget effect will be estimated with
<code>nugget.estim = TRUE</code>.</p></li>
<li><p>Also <code>jitter</code> is set to <code>TRUE</code> to circumvent a problem with <a href="https://CRAN.R-project.org/package=DiceKriging" class="external-link"><span class="pkg">DiceKriging</span></a>
where already trained input values produce the exact trained output.
Whether the objective function is noisy can be observed from the objective functions
properties.</p></li>
<li><p>Instead of the default <code>"BFGS"</code> optimization method we use rgenoud (<code>"gen"</code>),
which is a hybrid algorithm, to combine global search based on genetic algorithms and local search
based on gradients.
This may improve the model fit and will less frequently produce a constant surrogate model.</p></li>
</ul><p>For mixed numeric-categorical parameter spaces, or spaces with conditional parameters:</p><ul><li><p>A ranger regression forest “"regr.ranger"” with 500 trees is created.</p></li>
<li><p>The standard error of a prediction (if required by the infill criterion) is estimated via jackknife.
This is the <code>se.method = "jack"</code> option of the “"regr.ranger"” learner (default).</p></li>
</ul><p>In any case, learners are encapsulated using “"evaluate"”, and a fallback learner is set,
in cases where the surrogate learner errors. Currently, the following learner is used as a fallback:
<code>lrn("regr.ranger", num.trees = 20L, keep.inbag = TRUE, se.method = "jack")</code>.</p>
<p>If additionally dependencies are present in the parameter space, inactive conditional parameters
are represented by missing <code>NA</code> values in the training design data.
We simply handle those with an imputation method, added to the ranger random forest, more
concretely we use <code>po("imputesample")</code> (for logicals) and <code>po("imputeoor")</code> (for anything else) from
package <a href="https://CRAN.R-project.org/package=mlr3pipelines" class="external-link"><span class="pkg">mlr3pipelines</span></a>.
Characters are always encoded as factors via <code>po("colapply")</code>.
Out of range imputation makes sense for tree-based methods and is usually hard to beat, see Ding et al. (2010).
In the case of dependencies, the following learner is used as a fallback:
<code>lrn("regr.featureless")</code>.</p>
<p>If the instance is of class <a href="https://bbotk.mlr-org.com/reference/OptimInstanceSingleCrit.html" class="external-link">bbotk::OptimInstanceSingleCrit</a> the learner is wrapped as a
<a href="SurrogateLearner.html">SurrogateLearner</a>.</p>
<p>If the instance is of class <a href="https://bbotk.mlr-org.com/reference/OptimInstanceMultiCrit.html" class="external-link">bbotk::OptimInstanceMultiCrit</a> deep clones of the learner are
wrapped as a <a href="SurrogateLearnerCollection.html">SurrogateLearnerCollection</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">default_surrogate</span><span class="op">(</span><span class="va">instance</span>, learner <span class="op">=</span> <span class="cn">NULL</span>, n_learner <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>instance</dt>
<dd><p>(<a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">bbotk::OptimInstance</a>)<br>
An object that inherits from <a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">bbotk::OptimInstance</a>.</p></dd>


<dt>learner</dt>
<dd><p>(<code>NULL</code> | <a href="https://mlr3.mlr-org.com/reference/Learner.html" class="external-link">mlr3::Learner</a>).</p></dd>


<dt>n_learner</dt>
<dd><p>(<code>NULL</code> | <code>integer(1)</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><a href="Surrogate.html">Surrogate</a></p>


    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Ding, Yufeng, Simonoff, S J (2010).
“An Investigation of Missing Data Methods for Classification Trees Applied to Binary Response Data.”
<em>Journal of Machine Learning Research</em>, <b>11</b>(1), 131--170.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other mbo_defaults: 
<code><a href="default_acqfunction.html">default_acqfunction</a>()</code>,
<code><a href="default_acqoptimizer.html">default_acqoptimizer</a>()</code>,
<code><a href="default_loop_function.html">default_loop_function</a>()</code>,
<code><a href="default_result_assigner.html">default_result_assigner</a>()</code>,
<code><a href="mbo_defaults.html">mbo_defaults</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Lennart Schneider, Jakob Richter, Marc Becker, Michel Lang, Bernd Bischl, Florian Pfisterer, Martin Binder, Sebastian Fischer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

