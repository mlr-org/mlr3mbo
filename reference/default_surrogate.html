<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Default Surrogate — default_surrogate • mlr3mbo</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Default Surrogate — default_surrogate"><meta property="og:description" content="This is a helper function that generates a default Surrogate based on properties of the
bbotk::OptimInstance.
For numeric-only (including integers) parameter spaces without any dependencies:
A Kriging model &amp;#8220;&quot;regr.km&quot;&amp;#8221; with kernel &amp;#8220;&quot;matern3_2&quot;&amp;#8221; is created.
If the objective function is deterministic we add a small nugget effect (10^-8*Var(y),
y is vector of observed outcomes in current design) to increase numerical stability to
hopefully prevent crashes of DiceKriging.
Whether the objective function is deterministic can be observed from the objective function's
properties.
If the objective function is noisy the nugget effect will be estimated with
nugget.estim = TRUE.
Also jitter is set to TRUE to circumvent a problem with DiceKriging
where already trained input values produce the exact trained output.
Whether the objective function is noisy can be observed from the objective functions
properties.
Instead of the default &quot;BFGS&quot; optimization method we use rgenoud (&quot;gen&quot;),
which is a hybrid algorithm, to combine global search based on genetic algorithms and local search
based on gradients.
This may improve the model fit and will less frequently produce a constant surrogate model.


For mixed numeric-categorical parameter spaces, or spaces with conditional parameters:
A ranger regression forest &amp;#8220;&quot;regr.ranger&quot;&amp;#8221; with 500 trees is created.
The standard error of a prediction (if required by the infill criterion) is estimated
by computing the infinitesimal jackknife.
This is the se.method = &quot;infjack&quot; option of the &amp;#8220;&quot;regr.ranger&quot;&amp;#8221; learner (default).
In any case, learners are encapsulated using &amp;#8220;&quot;evaluate&quot;&amp;#8221;, and a fallback learner is set,
in cases where the surrogate learner errors. Currently, the following learner is used as a fallback:
lrn(&quot;regr.ranger&quot;, num.trees = 20L, keep.inbag = TRUE).
If additionally dependencies are present in the parameter space, inactive conditional parameters
are represented by missing NA values in the training design data.
We simply handle those with an imputation method, added to the ranger random forest, more
concretely we use po(&quot;imputesample&quot;) and po(&quot;imputeoor&quot;) from package mlr3pipelines.
Both of these techniques make sense for tree-based methods and are usually hard to beat, see Ding et al. (2010).
In the case of dependencies, the following learner is used as a fallback:
lrn(&quot;regr.featureless&quot;).
If the instance is of class bbotk::OptimInstanceSingleCrit the learner is wrapped as a
SurrogateLearner.
If the instance is of class bbotk::OptimInstanceMultiCrit deep clones of the learner are
wrapped as a SurrogateLearners."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mlr3mbo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">
    <span class="fa fa-file-alt"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="https://mlr3book.mlr-org.com" class="external-link">
    <span class="fa fa-link"></span>
     
    mlr3book
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mlr-org/mlr3mbo/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.slack.com" class="external-link">
    <span class="fab fa-slack"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr3" class="external-link">
    <span class="fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/" class="external-link">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Default Surrogate</h1>
    <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3mbo/blob/HEAD/R/mbo_defaults.R" class="external-link"><code>R/mbo_defaults.R</code></a></small>
    <div class="hidden name"><code>default_surrogate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is a helper function that generates a default <a href="Surrogate.html">Surrogate</a> based on properties of the
<a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">bbotk::OptimInstance</a>.</p>
<p>For numeric-only (including integers) parameter spaces without any dependencies:</p><ul><li><p>A Kriging model “"regr.km"” with kernel “"matern3_2"” is created.</p></li>
<li><p>If the objective function is deterministic we add a small nugget effect (10^-8*Var(y),
y is vector of observed outcomes in current design) to increase numerical stability to
hopefully prevent crashes of <a href="https://CRAN.R-project.org/package=DiceKriging" class="external-link"><span class="pkg">DiceKriging</span></a>.
Whether the objective function is deterministic can be observed from the objective function's
properties.</p></li>
<li><p>If the objective function is noisy the nugget effect will be estimated with
<code>nugget.estim = TRUE</code>.</p></li>
<li><p>Also <code>jitter</code> is set to <code>TRUE</code> to circumvent a problem with <a href="https://CRAN.R-project.org/package=DiceKriging" class="external-link"><span class="pkg">DiceKriging</span></a>
where already trained input values produce the exact trained output.
Whether the objective function is noisy can be observed from the objective functions
properties.</p></li>
<li><p>Instead of the default <code>"BFGS"</code> optimization method we use rgenoud (<code>"gen"</code>),
which is a hybrid algorithm, to combine global search based on genetic algorithms and local search
based on gradients.
This may improve the model fit and will less frequently produce a constant surrogate model.</p></li>
</ul><p>For mixed numeric-categorical parameter spaces, or spaces with conditional parameters:</p><ul><li><p>A ranger regression forest “"regr.ranger"” with 500 trees is created.</p></li>
<li><p>The standard error of a prediction (if required by the infill criterion) is estimated
by computing the infinitesimal jackknife.
This is the <code>se.method = "infjack"</code> option of the “"regr.ranger"” learner (default).</p></li>
</ul><p>In any case, learners are encapsulated using “"evaluate"”, and a fallback learner is set,
in cases where the surrogate learner errors. Currently, the following learner is used as a fallback:
<code>lrn("regr.ranger", num.trees = 20L, keep.inbag = TRUE)</code>.</p>
<p>If additionally dependencies are present in the parameter space, inactive conditional parameters
are represented by missing <code>NA</code> values in the training design data.
We simply handle those with an imputation method, added to the ranger random forest, more
concretely we use <code>po("imputesample")</code> and <code>po("imputeoor")</code> from package <a href="https://CRAN.R-project.org/package=mlr3pipelines" class="external-link"><span class="pkg">mlr3pipelines</span></a>.
Both of these techniques make sense for tree-based methods and are usually hard to beat, see Ding et al. (2010).
In the case of dependencies, the following learner is used as a fallback:
<code>lrn("regr.featureless")</code>.</p>
<p>If the instance is of class <a href="https://bbotk.mlr-org.com/reference/OptimInstanceSingleCrit.html" class="external-link">bbotk::OptimInstanceSingleCrit</a> the learner is wrapped as a
<a href="SurrogateLearner.html">SurrogateLearner</a>.</p>
<p>If the instance is of class <a href="https://bbotk.mlr-org.com/reference/OptimInstanceMultiCrit.html" class="external-link">bbotk::OptimInstanceMultiCrit</a> deep clones of the learner are
wrapped as a <a href="SurrogateLearners.html">SurrogateLearners</a>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">default_surrogate</span><span class="op">(</span><span class="va">instance</span>, learner <span class="op">=</span> <span class="cn">NULL</span>, n_learner <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>instance</dt>
<dd><p>(<a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">bbotk::OptimInstance</a>)<br>
An object that inherits from <a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">bbotk::OptimInstance</a>.</p></dd>


<dt>learner</dt>
<dd><p>(<code>NULL</code> | <a href="https://mlr3.mlr-org.com/reference/Learner.html" class="external-link">mlr3::Learner</a>).</p></dd>


<dt>n_learner</dt>
<dd><p>(<code>NULL</code> | <code>integer(1)</code>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><a href="Surrogate.html">Surrogate</a></p>


    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ding, Yufeng, Simonoff, S J (2010).
“An investigation of missing data methods for classification trees applied to binary response data.”
<em>Journal of Machine Learning Research</em>, <b>11</b>(1), 131--170.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other mbo_defaults: 
<code><a href="default_acqfun.html">default_acqfun</a>()</code>,
<code><a href="default_acqopt.html">default_acqopt</a>()</code>,
<code><a href="default_loopfun.html">default_loopfun</a>()</code>,
<code><a href="mbo_defaults.html">mbo_defaults</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lennart Schneider, Jakob Richter, Marc Becker, Michel Lang, Bernd Bischl, Martin Binder, Julia Moosbauer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

